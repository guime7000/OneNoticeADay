
<h1>numpy.linalg.lstsq<a class="headerlink" href="#numpy-linalg-lstsq" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="numpy.linalg.lstsq">
<span class="sig-prename descclassname"><span class="pre">linalg.</span></span><span class="sig-name descname"><span class="pre">lstsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'warn'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/numpy/numpy/blob/v1.24.0/numpy/linalg/linalg.py#L2150-L2307"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#numpy.linalg.lstsq" title="Permalink to this definition">#</a></dt>
<dd><p>Return the least-squares solution to a linear matrix equation.</p>
<p>Computes the vector <em class="xref py py-obj">x</em> that approximately solves the equation
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#64;</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">b</span></code>. The equation may be under-, well-, or over-determined
(i.e., the number of linearly independent rows of <em class="xref py py-obj">a</em> can be less than,
equal to, or greater than its number of linearly independent columns).
If <em class="xref py py-obj">a</em> is square and of full rank, then <em class="xref py py-obj">x</em> (but for round-off error)
is the “exact” solution of the equation. Else, <em class="xref py py-obj">x</em> minimizes the
Euclidean 2-norm <span class="math notranslate nohighlight">\(||b - ax||\)</span>. If there are multiple minimizing
solutions, the one with the smallest 2-norm <span class="math notranslate nohighlight">\(||x||\)</span> is returned.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier">(M, N) array_like</span></dt><dd><p>“Coefficient” matrix.</p>
</dd>
<dt><strong>b</strong><span class="classifier">{(M,), (M, K)} array_like</span></dt><dd><p>Ordinate or “dependent variable” values. If <em class="xref py py-obj">b</em> is two-dimensional,
the least-squares solution is calculated for each of the <em class="xref py py-obj">K</em> columns
of <em class="xref py py-obj">b</em>.</p>
</dd>
<dt><strong>rcond</strong><span class="classifier">float, optional</span></dt><dd><p>Cut-off ratio for small singular values of <em class="xref py py-obj">a</em>.
For the purposes of rank determination, singular values are treated
as zero if they are smaller than <em class="xref py py-obj">rcond</em> times the largest singular
value of <em class="xref py py-obj">a</em>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.14.0: </span>If not set, a FutureWarning is given. The previous default
of <code class="docutils literal notranslate"><span class="pre">-1</span></code> will use the machine precision as <em class="xref py py-obj">rcond</em> parameter,
the new default will use the machine precision times <em class="xref py py-obj">max(M, N)</em>.
To silence the warning and use the new default, use <code class="docutils literal notranslate"><span class="pre">rcond=None</span></code>,
to keep using the old behavior, use <code class="docutils literal notranslate"><span class="pre">rcond=-1</span></code>.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>x</strong><span class="classifier">{(N,), (N, K)} ndarray</span></dt><dd><p>Least-squares solution. If <em class="xref py py-obj">b</em> is two-dimensional,
the solutions are in the <em class="xref py py-obj">K</em> columns of <em class="xref py py-obj">x</em>.</p>
</dd>
<dt><strong>residuals</strong><span class="classifier">{(1,), (K,), (0,)} ndarray</span></dt><dd><p>Sums of squared residuals: Squared Euclidean 2-norm for each column in
<code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">-</span> <span class="pre">a</span> <span class="pre">&#64;</span> <span class="pre">x</span></code>.
If the rank of <em class="xref py py-obj">a</em> is &lt; N or M &lt;= N, this is an empty array.
If <em class="xref py py-obj">b</em> is 1-dimensional, this is a (1,) shape array.
Otherwise the shape is (K,).</p>
</dd>
<dt><strong>rank</strong><span class="classifier">int</span></dt><dd><p>Rank of matrix <em class="xref py py-obj">a</em>.</p>
</dd>
<dt><strong>s</strong><span class="classifier">(min(M, N),) ndarray</span></dt><dd><p>Singular values of <em class="xref py py-obj">a</em>.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>LinAlgError</dt><dd><p>If computation does not converge.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lstsq.html#scipy.linalg.lstsq" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.lstsq</span></code></a></dt><dd><p>Similar function in SciPy.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>If <em class="xref py py-obj">b</em> is a matrix, then all array results are returned as matrices.</p>
<p class="rubric">Examples</p>
<p>Fit a line, <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">mx</span> <span class="pre">+</span> <span class="pre">c</span></code>, through some noisy data-points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span>
</pre></div>
</div>
<p>By examining the coefficients, we see that the line should have a
gradient of roughly 1 and cut the y-axis at, more or less, -1.</p>
<p>We can rewrite the line equation as <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">Ap</span></code>, where <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">[[x</span> <span class="pre">1]]</span></code>
and <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">[[m],</span> <span class="pre">[c]]</span></code>.  Now use <a class="reference internal" href="#numpy.linalg.lstsq" title="numpy.linalg.lstsq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lstsq</span></code></a> to solve for <em class="xref py py-obj">p</em>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span>
<span class="go">array([[ 0.,  1.],</span>
<span class="go">       [ 1.,  1.],</span>
<span class="go">       [ 2.,  1.],</span>
<span class="go">       [ 3.,  1.]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">c</span>
<span class="go">(1.0 -0.95) # may vary</span>
</pre></div>
</div>
<p>Plot the data along with the fitted line:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../../_images/numpy-linalg-lstsq-1.png" class="plot-directive" src="../../_images/numpy-linalg-lstsq-1.png" />
</figure>
</dd></dl>

