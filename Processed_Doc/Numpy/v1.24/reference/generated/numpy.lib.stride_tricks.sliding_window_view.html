
<h1>numpy.lib.stride_tricks.sliding_window_view<a class="headerlink" href="#numpy-lib-stride-tricks-sliding-window-view" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="numpy.lib.stride_tricks.sliding_window_view">
<span class="sig-prename descclassname"><span class="pre">lib.stride_tricks.</span></span><span class="sig-name descname"><span class="pre">sliding_window_view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subok</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writeable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/numpy/numpy/blob/v1.24.0/numpy/lib/stride_tricks.py#L123-L337"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#numpy.lib.stride_tricks.sliding_window_view" title="Permalink to this definition">#</a></dt>
<dd><p>Create a sliding window view into the array with the given window shape.</p>
<p>Also known as rolling or moving window, the window slides across all
dimensions of the array and extracts subsets of the array at all window
positions.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.20.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>Array to create the sliding window view from.</p>
</dd>
<dt><strong>window_shape</strong><span class="classifier">int or tuple of int</span></dt><dd><p>Size of window over each axis that takes part in the sliding window.
If <em class="xref py py-obj">axis</em> is not present, must have same length as the number of input
array dimensions. Single integers <em class="xref py py-obj">i</em> are treated as if they were the
tuple <em class="xref py py-obj">(i,)</em>.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int or tuple of int, optional</span></dt><dd><p>Axis or axes along which the sliding window is applied.
By default, the sliding window is applied to all axes and
<em class="xref py py-obj">window_shape[i]</em> will refer to axis <em class="xref py py-obj">i</em> of <em class="xref py py-obj">x</em>.
If <em class="xref py py-obj">axis</em> is given as a <em class="xref py py-obj">tuple of int</em>, <em class="xref py py-obj">window_shape[i]</em> will refer to
the axis <em class="xref py py-obj">axis[i]</em> of <em class="xref py py-obj">x</em>.
Single integers <em class="xref py py-obj">i</em> are treated as if they were the tuple <em class="xref py py-obj">(i,)</em>.</p>
</dd>
<dt><strong>subok</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, sub-classes will be passed-through, otherwise the returned
array will be forced to be a base-class array (default).</p>
</dd>
<dt><strong>writeable</strong><span class="classifier">bool, optional</span></dt><dd><p>When true, allow writing to the returned view. The default is false,
as this should be used with caution: the returned view contains the
same memory location multiple times, so writing to one location will
cause others to change.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>view</strong><span class="classifier">ndarray</span></dt><dd><p>Sliding window view of the array. The sliding window dimensions are
inserted at the end, and the original dimensions are trimmed as
required by the size of the sliding window.
That is, <code class="docutils literal notranslate"><span class="pre">view.shape</span> <span class="pre">=</span> <span class="pre">x_shape_trimmed</span> <span class="pre">+</span> <span class="pre">window_shape</span></code>, where
<code class="docutils literal notranslate"><span class="pre">x_shape_trimmed</span></code> is <code class="docutils literal notranslate"><span class="pre">x.shape</span></code> with every entry reduced by one less
than the corresponding window size.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="numpy.lib.stride_tricks.as_strided.html#numpy.lib.stride_tricks.as_strided" title="numpy.lib.stride_tricks.as_strided"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lib.stride_tricks.as_strided</span></code></a></dt><dd><p>A lower-level and less safe routine for creating arbitrary views from custom shape and strides.</p>
</dd>
<dt><a class="reference internal" href="numpy.broadcast_to.html#numpy.broadcast_to" title="numpy.broadcast_to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">broadcast_to</span></code></a></dt><dd><p>broadcast an array to a given shape.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For many applications using a sliding window view can be convenient, but
potentially very slow. Often specialized solutions exist, for example:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.fftconvolve.html#scipy.signal.fftconvolve" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.fftconvolve</span></code></a></p></li>
<li><p>filtering functions in <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/ndimage.html#module-scipy.ndimage" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.ndimage</span></code></a></p></li>
<li><p>moving window functions provided by
<a class="reference external" href="https://github.com/pydata/bottleneck">bottleneck</a>.</p></li>
</ul>
<p>As a rough estimate, a sliding window approach with an input size of <em class="xref py py-obj">N</em>
and a window size of <em class="xref py py-obj">W</em> will scale as <em class="xref py py-obj">O(N*W)</em> where frequently a special
algorithm can achieve <em class="xref py py-obj">O(N)</em>. That means that the sliding window variant
for a window size of 100 can be a 100 times slower than a more specialized
version.</p>
<p>Nevertheless, for small window sizes, when no custom algorithm exists, or
as a prototyping and developing tool, this function can be a good solution.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [1, 2, 3],</span>
<span class="go">       [2, 3, 4],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<p>This also works in more dimensions, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ogrid</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">array([[ 0,  1,  2,  3],</span>
<span class="go">       [10, 11, 12, 13],</span>
<span class="go">       [20, 21, 22, 23]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 3, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">array([[[[ 0,  1],</span>
<span class="go">         [10, 11]],</span>
<span class="go">        [[ 1,  2],</span>
<span class="go">         [11, 12]],</span>
<span class="go">        [[ 2,  3],</span>
<span class="go">         [12, 13]]],</span>
<span class="go">       [[[10, 11],</span>
<span class="go">         [20, 21]],</span>
<span class="go">        [[11, 12],</span>
<span class="go">         [21, 22]],</span>
<span class="go">        [[12, 13],</span>
<span class="go">         [22, 23]]]])</span>
</pre></div>
</div>
<p>The axis can be specified explicitly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">array([[[ 0, 10, 20],</span>
<span class="go">        [ 1, 11, 21],</span>
<span class="go">        [ 2, 12, 22],</span>
<span class="go">        [ 3, 13, 23]]])</span>
</pre></div>
</div>
<p>The same axis can be used several times. In that case, every use reduces
the corresponding original dimension:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 1, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">array([[[[ 0,  1,  2],</span>
<span class="go">         [ 1,  2,  3]]],</span>
<span class="go">       [[[10, 11, 12],</span>
<span class="go">         [11, 12, 13]]],</span>
<span class="go">       [[[20, 21, 22],</span>
<span class="go">         [21, 22, 23]]]])</span>
</pre></div>
</div>
<p>Combining with stepped slicing (<em class="xref py py-obj">::step</em>), this can be used to take sliding
views which skip elements:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="go">array([[0, 2, 4],</span>
<span class="go">       [1, 3, 5],</span>
<span class="go">       [2, 4, 6]])</span>
</pre></div>
</div>
<p>or views which move by multiple elements</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [2, 3, 4],</span>
<span class="go">       [4, 5, 6]])</span>
</pre></div>
</div>
<p>A common application of <a class="reference internal" href="#numpy.lib.stride_tricks.sliding_window_view" title="numpy.lib.stride_tricks.sliding_window_view"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sliding_window_view</span></code></a> is the calculation of running
statistics. The simplest example is the
<a class="reference external" href="https://en.wikipedia.org/wiki/Moving_average">moving average</a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(6,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">sliding_window_view</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span>
<span class="go">array([[0, 1, 2],</span>
<span class="go">       [1, 2, 3],</span>
<span class="go">       [2, 3, 4],</span>
<span class="go">       [3, 4, 5]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moving_average</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">moving_average</span>
<span class="go">array([1., 2., 3., 4.])</span>
</pre></div>
</div>
<p>Note that a sliding window approach is often <strong>not</strong> optimal (see Notes).</p>
</dd></dl>

