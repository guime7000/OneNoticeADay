
<h1>numpy.linalg.pinv<a class="headerlink" href="#numpy-linalg-pinv" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="numpy.linalg.pinv">
<span class="sig-prename descclassname"><span class="pre">linalg.</span></span><span class="sig-name descname"><span class="pre">pinv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hermitian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/numpy/numpy/blob/v1.24.0/numpy/linalg/linalg.py#L1897-L1992"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#numpy.linalg.pinv" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the (Moore-Penrose) pseudo-inverse of a matrix.</p>
<p>Calculate the generalized inverse of a matrix using its
singular-value decomposition (SVD) and including all
<em>large</em> singular values.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.14: </span>Can now operate on stacks of matrices</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>a</strong><span class="classifier">(…, M, N) array_like</span></dt><dd><p>Matrix or stack of matrices to be pseudo-inverted.</p>
</dd>
<dt><strong>rcond</strong><span class="classifier">(…) array_like of float</span></dt><dd><p>Cutoff for small singular values.
Singular values less than or equal to
<code class="docutils literal notranslate"><span class="pre">rcond</span> <span class="pre">*</span> <span class="pre">largest_singular_value</span></code> are set to zero.
Broadcasts against the stack of matrices.</p>
</dd>
<dt><strong>hermitian</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, <em class="xref py py-obj">a</em> is assumed to be Hermitian (symmetric if real-valued),
enabling a more efficient method for finding singular values.
Defaults to False.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.17.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>B</strong><span class="classifier">(…, N, M) ndarray</span></dt><dd><p>The pseudo-inverse of <em class="xref py py-obj">a</em>. If <em class="xref py py-obj">a</em> is a <a class="reference internal" href="numpy.matrix.html#numpy.matrix" title="numpy.matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix</span></code></a> instance, then so
is <em class="xref py py-obj">B</em>.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>LinAlgError</dt><dd><p>If the SVD computation does not converge.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinv.html#scipy.linalg.pinv" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.pinv</span></code></a></dt><dd><p>Similar function in SciPy.</p>
</dd>
<dt><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.pinvh.html#scipy.linalg.pinvh" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.linalg.pinvh</span></code></a></dt><dd><p>Compute the (Moore-Penrose) pseudo-inverse of a Hermitian matrix.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The pseudo-inverse of a matrix A, denoted <span class="math notranslate nohighlight">\(A^+\)</span>, is
defined as: “the matrix that ‘solves’ [the least-squares problem]
<span class="math notranslate nohighlight">\(Ax = b\)</span>,” i.e., if <span class="math notranslate nohighlight">\(\bar{x}\)</span> is said solution, then
<span class="math notranslate nohighlight">\(A^+\)</span> is that matrix such that <span class="math notranslate nohighlight">\(\bar{x} = A^+b\)</span>.</p>
<p>It can be shown that if <span class="math notranslate nohighlight">\(Q_1 \Sigma Q_2^T = A\)</span> is the singular
value decomposition of A, then
<span class="math notranslate nohighlight">\(A^+ = Q_2 \Sigma^+ Q_1^T\)</span>, where <span class="math notranslate nohighlight">\(Q_{1,2}\)</span> are
orthogonal matrices, <span class="math notranslate nohighlight">\(\Sigma\)</span> is a diagonal matrix consisting
of A’s so-called singular values, (followed, typically, by
zeros), and then <span class="math notranslate nohighlight">\(\Sigma^+\)</span> is simply the diagonal matrix
consisting of the reciprocals of A’s singular values
(again, followed by zeros). <a class="reference internal" href="#rec505eafac9d-1" id="id1">[1]</a></p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rec505eafac9d-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>G. Strang, <em>Linear Algebra and Its Applications</em>, 2nd Ed., Orlando,
FL, Academic Press, Inc., 1980, pp. 139-142.</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>The following example checks that <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">a+</span> <span class="pre">*</span> <span class="pre">a</span> <span class="pre">==</span> <span class="pre">a</span></code> and
<code class="docutils literal notranslate"><span class="pre">a+</span> <span class="pre">*</span> <span class="pre">a</span> <span class="pre">*</span> <span class="pre">a+</span> <span class="pre">==</span> <span class="pre">a+</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">B</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

